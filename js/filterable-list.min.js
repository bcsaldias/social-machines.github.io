function createFilterableList(e){function t(){l(),r(),i()}function r(){n(),a()}function n(){w.selectAll(".filter-tag-item").classed("active",function(e){return x.includes(e)}).classed("teal",function(e){return x.includes(e)})}function a(){var e=P.selectAll(".filtered-list-group").data(d,function(e){return e.key});e.exit().remove();var t=e.enter().append("div").attr("class","filtered-list-group");t.append("h3").attr("class","ui header").text(function(e){return"__null"===e.key?"Other":e.key});t.append("ul").attr("class","filtered-list-group-list "+(h||""));var r=t.merge(e).select("ul").selectAll(".filtered-list-item").data(function(e){return e.values},function(e){return e.id});r.exit().remove(),r.enter().append("li").attr("class","filtered-list-item").merge(r).html(m)}function i(){var e=y.length?encodeURIComponent(y):void 0,t=x.length?encodeURIComponent(x.join("__")):void 0,r=window.location.href;r=updateQueryParam(r=updateQueryParam(r,"q",e),"tags",t),window.history.replaceState({encodedInputString:e,encodedTags:t},"",r)}function l(){o=p.filter(u).filter(c),d=d3.nest().key(function(e){return null==e[g]?"__null":e[g]}).entries(o).sort(function(e,t){return t.key-e.key})}function u(e){if(!x.length)return!0;var t=e[v];Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;++r)for(var n=t[r],a=0;a<x.length;++a)if(n===x[a])return!0;return!1}function c(e){if(!y.trim().length)return!0;var t=["html","id"];return Object.keys(e).filter(function(e){return!t.includes(e)}).map(function(t){return e[t]}).join("\n").toLowerCase().includes(y.trim().toLowerCase())}function s(e){y=e,t()}var o,d,f=e.rootSelector,p=(e.title,e.data),v=e.tagKey,g=e.groupBy,m=e.renderItem,h=e.listClass,y="",x=[];!function(){var e=getUrlQueryParams();y=e.q||"",x=e.tags?e.tags.split("__"):[]}();var k=d3.select(f),w=(k.append("div").attr("class","ui input").append("input").attr("type","text").attr("class","filter-input").attr("placeholder","Search...").attr("value",y).on("change keyup",function(){s(this.value)}),k.append("div").attr("class","filter-tags"));w.append("div").attr("class","filter-label").text("Filter by Tag");var A=function(){var e={};return p.forEach(function(t){var r=t[v];null!=r&&(Array.isArray(r)?r.forEach(function(t){e[t]=!0}):e[r]=!0)}),Object.keys(e)}();w.selectAll("a").data(A).enter().append("a").attr("class","filter-tag-item ui label").on("click",function(e){-1!==x.indexOf(e)?x.splice(x.indexOf(e),1):x.push(e),t()}).classed("active",function(e){return x.includes(e)}).classed("teal",function(e){return x.includes(e)}).text(function(e){return e});var P=k.append("div").attr("class","filtered-list");t()}function clearData(e){d3.select(e).html("")}function updateQueryParam(e,t,r){var n=new RegExp("([?&])"+t+"=.*?(&|#|$)","i");if(void 0===r)return e.match(n)?e.replace(n,"$1$2").replace(/&+/g,"&").replace(/&$/,"").replace(/\?$/,""):e;if(e.match(n))return e.replace(n,"$1"+t+"="+r+"$2");var a="";return-1!==e.indexOf("#")&&(a=e.replace(/.*#/,"#"),e=e.replace(/#.*/,"")),e+(-1!==e.indexOf("?")?"&":"?")+t+"="+r+a}function getUrlQueryParams(){var e,t=/\+/g,r=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(t," "))},a=window.location.search.substring(1);for(urlParams={};e=r.exec(a);)urlParams[n(e[1])]=n(e[2]);return urlParams}
